<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

<style>
@import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500&display=swap');
@media (min-width: 768px) {main {max-width: 420px;}}
body {
	margin: 0;
	padding: 0;
	font-family: 'Ubuntu', sans-serif !important;
	font-weight: 300 !important;
}
main {
	width: 100%;
	display: flex;
	min-height: 100vh;
	align-items: center;
	justify-content: center;
}
section {
	width: 100%;
	height: 100%;
	display: block;
	text-align: center;
	justify-content: center;
}
h1 {
    font-size: 2.5em!important;
}
a {
    text-decoration: none!important;
    color: #ffffff!important;
}
</style>
<title>Form To Google Sheets </title>
</head>
<body class="bg-dark">
<main class="m-auto text-light">
<section class="container-fluid">
    
<!--- form --->
<form class="container" name="sheet">
    <h1>
        <img src="praba.png" width="80"/>
        <b>LasPraba</b>
    </h1>
<div class="accordion mb-2" id="accordionExample">
  <div class="accordion-item">
    <h2 class="accordion-header">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
        <h2><b>Purchase</b></h2>
      </button>
    </h2>
    <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <textarea class="form-control" type="text" name="Description" placeholder="Description"rows=""></textarea>
        <input class="form-control" type="number" name="Amount" placeholder="Amount">
        <input class="form-control" type="number" name="UnitPrice" placeholder="UnitPrice">
        <input class="form-control" type="number" name="Expenditure" placeholder="AllPrices">
        <button class="btn btn-dark w-100 my-4" type="submit">Submit</button>
      </div>
    </div>
  </div>
  <div class="accordion-item">
    <h2 class="accordion-header">
      <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
        <h2><b>Finance</b></h2>
      </button>
    </h2>
    <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
      <div class="accordion-body">
        <input class="form-control" type="number" name="Expenditure" placeholder="Expenditure">
        <input class="form-control" type="number" name="income" placeholder="income">
        <textarea class="form-control" type="text" name="Description" placeholder="Informations" rows="4"></textarea>
        <button class="btn btn-dark w-100 my-4" type="submit">Submit</button>
      </div>
    </div>
  </div>
</div>
<a href="https://docs.google.com/spreadsheets/d/1ehPLR8VSdkMdaNEyTOn2A8nT-75FbpYiVoEKxjrK8Fs/edit?usp=drivesdk">View To Google Sheets</a>
</form>   

<!--- script form --->
<input class="send spinner-border d-none bg-dark text-light">
<a href="" class="save d-none text-light"><h2>Success !</h2><p>Data Anda berhasil disimpan</p></a>
<a href="" class="error d-none text-light"><h2>Error !</h2><p>Data Anda gagal disimpan</p></a>
<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbw37cppc_ejtsuzQH1ryD3fKcwGYn8PrphHaLjy4c1u9tWStYLQKNhud0sPwOzgDp29/exec'
    const form = document.forms['sheet']
    const send = document.querySelector('.send')
    const save = document.querySelector('.save')
    const error = document.querySelector('.error')

    form.addEventListener('submit', e => {
      e.preventDefault()
      showLoadingIndicator()
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => showSuccessMessage(response))
        .catch(error => showErrorMessage(error))
    })

    function showLoadingIndicator () {
      form.classList.add('d-none')
      send.classList.remove('d-none')
    }

    function showSuccessMessage (response) {
      console.log('Success!', response)
      setTimeout(() => {
        save.classList.remove('d-none')
        send.classList.add('d-none')
      }, 1000)
    }

    function showErrorMessage (error) {
      console.error('Error!', error.message)
      setTimeout(() => {
        error.classList.remove('d-none')
        send.classList.add('d-none')
      }, 100)
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</section>
</main>
</body>
</html>
