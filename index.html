<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<style>
@import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500&display=swap');
@media (min-width: 768px) {main {max-width: 420px;}}
body {
	font-family: 'Ubuntu', sans-serif !important;
	font-weight: 300 !important;
}
main {
    width: 100%;
	display: flex;
	min-height: 100vh;
	align-items: center;
	justify-content: center;
}
a {
    text-decoration: none!important;
}
h2 {
    font-size: 4em;
}

</style>
<title>Purchase</title>
</head>
<body>
<main class="m-auto px-2">
<div class="container card">
  <div class="card-header">
    <h1>Purchase & Payment</h1>
  </div>
  <div class="card-body">
    <form name="sheet">
        <textarea class="form-control my-2" type="text" name="Description" placeholder="Description / Product Name"rows="4"></textarea>
        <input class="form-control my-2" type="number" name="Amount" placeholder="Amount">
        <input class="form-control my-2" type="number" name="UnitPrice" placeholder="Unit Price">
        <input class="form-control my-2" type="number" name="Payment" placeholder="Payment" required>
    
        <button class="save btn btn-dark w-100 my-4 py-2" type="submit">Save</button>
        
        <button class="loading btn btn-dark d-none w-100 my-4 py-2" type="button">
            <span class="spinner-border spinner-border-sm p-2" aria-hidden="true"></span>
        </button>
        
        <a href="">
            <span class="success btn btn-dark w-100 my-4 py-2 d-none">Data Saved Successfully</span>
            <span class="error btn btn-dark text-danger w-100 my-4 py-2 d-none">Data Failed To Save</span>
        </a>
<a href="https://docs.google.com/spreadsheets/d/1UXof3V88crJH3E13nOYy3D_PvsRjoO9I34E0J9-JddU/edit?usp=drivesdk">View The Google Sheets</a><br>
        <a href="https://script.google.com/macros/s/AKfycbzDPjzRsA-0RmcR-obKQuipgIKsfO3qTFRR1vLPAWnSLyzz2h5gFs8Y3lkBNSaiUbm7HA/exec">Show Data</a>
    </form> 
    <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzmhnKBxtUljwAp9hFU-_O_r_zQwFIQXxyWEoqKGr8AM84HptuMNQjBqNRjIcXI3ePvyQ/exec'
    const form = document.forms['sheet']
    const save = document.querySelector('.save')
    const loading = document.querySelector('.loading')
    const success = document.querySelector('.success')
    const error = document.querySelector('.error')

    form.addEventListener('submit', e => {
      e.preventDefault()
      showLoadingIndicator()
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => showSuccessMessage(response))
        .catch(error => showErrorMessage(error))
    })

    function showLoadingIndicator () {
      save.classList.add('d-none')
      loading.classList.remove('d-none')
    }

    function showSuccessMessage (response) {
      console.log('Success!', response)
      setTimeout(() => {
        success.classList.remove('d-none')
        loading.classList.add('d-none')
      }, 1000)
    }

    function showErrorMessage (error) {
      console.error('Error!', error.message)
      setTimeout(() => {
        error.classList.remove('d-none')
        loading.classList.add('d-none')
      }, 100)
    }
    </script>
  </div>
</div>
</main>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>

<!---
AppScript Sheet1 Url: 

https://script.google.com/macros/s/AKfycbzmhnKBxtUljwAp9hFU-_O_r_zQwFIQXxyWEoqKGr8AM84HptuMNQjBqNRjIcXI3ePvyQ/exec

Show Data Url:

https://script.google.com/macros/s/AKfycbzDPjzRsA-0RmcR-obKQuipgIKsfO3qTFRR1vLPAWnSLyzz2h5gFs8Y3lkBNSaiUbm7HA/exec"

--->