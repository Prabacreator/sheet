<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<style>
@import url('https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500&display=swap');
@media (min-width: 768px) {main {max-width: 420px;}}
body {
	font-family: 'Ubuntu', sans-serif !important;
	font-weight: 300 !important;
}
main {
    width: 100%;
    display: flex;
	min-height: 100vh;
	align-items: center;
	justify-content: center;
}
section {
    width: 100%;
	height: 100v%;
	display: block;
	text-align: center;
	justify-content: center;
}

a {
    text-decoration: none!important;
}

</style>
</head>
<body class="bg-dark">
    <main class="m-auto p-2">
    <section class="container">
        
    
        <form name="sheet">
        <table class="table">
            <tr>
                <th class="text-center" colspan="2">
                    <h2>Transaksi Keuangan</h2> 
                </th>
            </tr>
            <tr>
                <th colspan="2">
                    <iframe src="https://script.google.com/macros/s/AKfycbyhKjUAD6ZNCzfebOpIbRxqndz6qCQCYaeO0Wc0k5oFQSn3KD501cz00Bg8LIjJe3FhMw/exec"></iframe> 
                </th>
            </tr>
            <tr>
                <th>
                    Jenis
                </th>
                <td>
                    <select class="form-select" name="Jenis">
                      <option selected>Pengeluaran</option>
                      <option value="Pembelian">Pembelian</option>
                      <option value="Pemasukan">Pemasukan</option>
                    </select>
                </td>
            </tr>
            <tr>
                <th>Nominal</th>
                <td>
                <input class="form-control" type="number" name="Nominal" required>
                </td>
            </tr>
            <tr>
                <th>Keterangan</th>
                <td>
                <input class="form-control" type="text" name="Keterangan" required>
                </td>
            </tr>
            
            <tr>
                <th colspan="2">
                <button class="btn btn-dark save w-100 mb-5" type="submit">Save
                </button>
                <button class="btn btn-outline-dark loading d-none w-100 mb-5" type="button" disabled>
                    <span class="spinner-border spinner-border-sm" aria-hidden="true"></span>
                    <span>Loading ..</span>
                </button>
                <a href="">
                <button class="alert alert-danger error d-none w-100"type="button"><strong>Error</strong></button>
                </a>
                <a href="https://docs.google.com/spreadsheets/d/1MI1bTmINdb1QPCdZrvnUsAJIjC3p8Psb3_BB8-tedG4/edit?usp=drivesdk">View the google sheets</a>
                </th>
            </tr>
        </table>
        </form>
        
        
    </section>
    </main>
 <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxlEH88iIb7mRHEyFkvS0StYJV-H2myhKu4LMMLpthm6HYdATV13skdEruWHCxPbYjP0A/exec'
    const form = document.forms['sheet']
    const save = document.querySelector('.save')
    const loading = document.querySelector('.loading')
    const error = document.querySelector('.error')

    form.addEventListener('submit', e => {
      e.preventDefault()
      showLoadingIndicator()
      fetch(scriptURL, { method: 'POST', body: new FormData(form)})
        .then(response => showSuccessMessage(response))
        .catch(error => showErrorMessage(error))
    })

    function showLoadingIndicator () {
      save.classList.add('d-none')
      loading.classList.remove('d-none')
    }

    function showSuccessMessage (response) {
      console.log('Success!', response)
      setTimeout(() => {
        save.classList.remove('d-none');
        loading.classList.add('d-none');
        form.reset();
      }, 1000)
    }

    function showErrorMessage (error) {
      console.error('Error!', error.message)
      setTimeout(() => {
        error.classList.remove('d-none');
        loading.classList.add('d-none');
      }, 100)
    }
</script>
</body>
</html>

<!----( https://script.google.com/macros/s/AKfycbxlEH88iIb7mRHEyFkvS0StYJV-H2myhKu4LMMLpthm6HYdATV13skdEruWHCxPbYjP0A/exec )--->